# 业务属性定义功能PRD文档

## 1. 功能目标

### 1.1 主要目标
- 为数字孪生平台提供业务属性定义和管理功能
- 支持用户定义与业务管理相关的属性字段
- 实现业务属性的分类管理和标准化配置
- 提供业务属性的批量引用和模板化管理

### 1.2 具体目标
- 支持多种业务属性类型的定义（生产、运维、质量、责任等）
- 提供业务属性组的引用功能，提高配置效率
- 实现业务属性的验证规则和默认值设置
- 支持业务属性的状态管理和版本控制

## 2. 功能描述

### 2.1 核心功能
- **业务属性列表管理**：显示所有已定义的业务属性，支持增删改查操作
- **业务属性定义编辑**：通过抽屉式界面编辑业务属性详细信息
- **属性组引用**：支持引用已定义的业务属性组，批量添加属性
- **属性验证规则**：支持设置属性的验证规则和默认值
- **属性分类管理**：支持按业务类型对属性进行分类管理

### 2.2 功能特点
- **抽屉式交互**：业务属性编辑采用从右侧滑出的抽屉式界面
- **批量引用**：支持从属性组中批量引用业务属性
- **实时验证**：属性配置的实时校验和错误提示
- **分类管理**：支持业务属性的分类标识和管理

## 3. 交互说明

### 3.1 业务属性列表交互
- **查看属性**：点击属性名称链接，以只读模式查看属性详情
- **编辑属性**：点击编辑按钮，打开业务属性编辑抽屉
- **删除属性**：点击删除按钮，确认后删除业务属性
- **批量操作**：支持全选/取消全选，批量删除操作

### 3.2 业务属性编辑交互
- **抽屉打开**：从右侧滑出，占据700px宽度
- **表单填写**：按字段顺序填写业务属性信息
- **属性组选择**：点击"引用属性组"按钮，打开属性组选择模态框
- **验证规则设置**：根据数据类型动态显示相应的验证规则选项

### 3.3 属性组引用交互
- **模态框打开**：居中显示属性组选择界面
- **搜索过滤**：支持属性组名称的实时搜索
- **多选确认**：支持多选属性组，确认后批量添加业务属性
- **预览功能**：选择属性组后可预览将要添加的属性列表

### 3.4 属性验证交互
- **数据类型联动**：选择数据类型后，自动显示相应的验证选项
- **实时验证**：输入验证规则时实时检查格式正确性
- **默认值设置**：根据数据类型提供相应的默认值输入控件

## 4. 字段说明

### 4.1 基本信息字段
| 字段名称 | 字段类型 | 是否必填 | 说明 |
|---------|---------|---------|------|
| 属性名称 | 文本输入 | 是 | 业务属性名称，如"设备负责人" |
| 属性编码 | 文本输入 | 是 | 业务属性的英文编码，如"device_manager" |
| 数据类型 | 下拉选择 | 是 | 字符串、数值、布尔值、日期时间、枚举等 |
| 所属属性组 | 下拉选择 | 否 | 选择业务属性所属的属性组 |
| 是否必填 | 单选按钮 | 是 | 控制该属性是否为必填项 |
| 默认值 | 动态输入 | 否 | 根据数据类型提供相应的默认值输入 |

### 4.2 业务分类字段
| 字段名称 | 字段类型 | 是否必填 | 说明 |
|---------|---------|---------|------|
| 业务分类 | 下拉选择 | 是 | 生产属性、运维属性、质量属性、责任属性等 |
| 显示顺序 | 数字输入 | 否 | 属性在列表中的显示顺序 |
| 描述 | 文本域 | 否 | 业务属性的详细描述信息 |

### 4.3 验证规则字段
| 字段名称 | 字段类型 | 是否必填 | 说明 |
|---------|---------|---------|------|
| 取值范围 | 数值范围 | 否 | 数值类型的取值范围设置 |
| 格式验证 | 正则表达式 | 否 | 字符串类型的格式验证规则 |
| 枚举选项 | 多行文本 | 否 | 枚举类型的可选值列表 |
| 精度设置 | 数字输入 | 否 | 数值类型的小数位数精度 |

### 4.4 列表显示字段
| 字段名称 | 字段类型 | 说明 |
|---------|---------|------|
| 序号 | 数字 | 属性在列表中的序号 |
| 属性名称 | 链接 | 可点击查看属性详情 |
| 属性编码 | 文本 | 属性的唯一标识编码 |
| 数据类型 | 文本 | 属性的数据类型 |
| 所属属性组 | 文本 | 属性所属的属性组名称 |
| 必填 | 状态标签 | 是否必填的标识 |
| 默认值 | 文本 | 属性的默认值 |
| 描述 | 文本 | 属性的描述信息 |

## 5. 业务规则

### 5.1 属性命名规则
- **属性名称**：长度2-20个字符
- **属性编码**：必须为英文，长度3-50个字符，只能包含字母、数字、下划线
- **编码唯一性**：同一资产类型下业务属性编码必须唯一
- **名称唯一性**：同一资产类型下业务属性名称不能重复

### 5.2 数据类型规则
- **字符串类型**：支持长度限制、格式验证、正则表达式验证
- **数值类型**：支持整数、小数，可设置精度、取值范围
- **布尔值类型**：true/false，可设置默认值
- **日期时间类型**：支持日期、时间、日期时间格式
- **枚举类型**：必须提供枚举选项列表，选项不能为空

### 5.3 属性组引用规则
- **引用范围**：只能引用"业务属性组"类型的属性组
- **重复检查**：引用时自动检查是否与现有属性重复
- **批量添加**：支持一次性引用多个属性组
- **冲突处理**：编码冲突时提示用户选择覆盖或跳过

### 5.4 验证规则设置规则
- **数据类型联动**：验证规则必须与数据类型匹配
- **数值范围**：最小值不能大于最大值
- **精度设置**：精度必须在0-10范围内
- **枚举选项**：枚举选项不能为空，选项间用逗号分隔
- **格式验证**：正则表达式必须符合语法规范

### 5.5 业务分类规则
- **分类定义**：预定义生产、运维、质量、责任四大业务分类
- **分类用途**：用于业务属性的分类管理和统计分析
- **分类扩展**：支持后续添加新的业务分类
- **分类标识**：每个业务属性必须属于一个业务分类

### 5.6 必填项规则
- **系统字段**：系统预定义的业务属性默认为必填
- **自定义字段**：用户自定义的业务属性可设置是否必填
- **必填验证**：必填字段在保存时必须填写有效值
- **默认值影响**：有默认值的字段仍可设置为必填

### 5.7 默认值规则
- **类型匹配**：默认值必须与数据类型匹配
- **验证规则**：默认值必须通过验证规则检查
- **空值处理**：字符串类型支持空字符串作为默认值
- **动态默认值**：支持基于系统时间、用户信息等的动态默认值

### 5.8 权限控制规则
- **查看权限**：所有用户都可以查看业务属性列表和详情
- **编辑权限**：只有具有业务属性管理权限的用户才能编辑属性
- **删除权限**：只有具有业务属性管理权限的用户才能删除属性
- **操作日志**：所有业务属性操作都需要记录操作日志

### 5.9 数据验证规则
- **必填字段**：属性名称、属性编码、数据类型、业务分类为必填
- **格式验证**：属性编码必须符合命名规范
- **唯一性验证**：属性编码在同一资产类型下必须唯一
- **关联验证**：引用属性组时必须验证属性组的有效性

### 5.10 状态管理规则
- **启用状态**：新创建的业务属性默认为启用状态
- **停用状态**：停用的业务属性不会在实例化时显示
- **删除状态**：删除的业务属性会从列表中移除，但保留历史数据
- **状态变更**：状态变更需要记录操作人和操作时间

### 5.11 版本控制规则
- **版本继承**：业务属性支持从父类型继承
- **版本冲突**：子类型与父类型的同名属性发生冲突时，子类型优先