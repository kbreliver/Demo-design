# 工厂模型管理 - 采集参数 PRD文档

## 1. 功能目标

### 1.1 动态变量管理
- 提供资产类型动态变量的配置和管理功能
- 支持变量参数的实时编辑和验证
- 实现变量配置的批量操作和导入导出
- 提供数据点位批量新增功能

### 1.2 采集参数配置
- 支持采集频率、取值周期、取值方式等参数配置
- 提供数据分类和业务分类的管理
- 实现数据绑定的配置和管理
- 支持采集参数的实时监控和状态显示

## 2. 功能描述

### 2.1 动态变量列表
- **变量名称**：显示和编辑动态变量的标识名称
- **变量编码**：显示和编辑变量的唯一编码
- **数据类型**：支持数值、字符串、布尔值、枚举、日期、日期时间等类型
- **单位**：支持变量的计量单位配置
- **精度**：支持数值类型的精度设置

### 2.2 采集参数配置
- **采集频率**：配置数据采集的时间间隔
- **取值周期**：配置数据取值的统计周期
- **取值方式**：支持实时值、平均值、最大值、最小值等取值方式
- **数据分类**：配置数据的业务分类
- **业务分类**：配置数据的业务用途分类

### 2.3 数据绑定功能
- **数据源选择**：支持选择数据源进行数据绑定
- **数据点位配置**：支持配置具体的数据点位
- **绑定状态显示**：显示数据绑定的状态和配置信息
- **批量数据绑定**：支持批量配置数据绑定

## 3. 交互说明

### 3.1 页面加载
- 页面加载时根据选择的资产类型加载动态变量列表
- 初始化变量配置表单和验证规则
- 加载数据源列表和可用的数据点位
- 设置表格的编辑模式和显示模式

### 3.2 变量配置操作
- 点击新增参数按钮打开变量配置对话框
- 支持变量的实时编辑和验证
- 提供变量配置的保存和取消操作
- 支持变量配置的复制和删除

### 3.3 数据绑定操作
- 点击数据绑定按钮打开数据源选择对话框
- 支持数据源和数据点位的选择配置
- 提供数据绑定的测试和验证功能
- 支持数据绑定的解除和重新配置

## 4. 业务规则

### 4.1 动态变量规则
- 变量名称不能为空，长度限制1-50字符
- 变量编码在同一资产类型下必须唯一
- 变量数据类型必须符合系统支持的类型
- 必填字段不能为空

### 4.2 采集参数规则
- 采集频率必须大于0，单位支持秒、分钟、小时、天
- 取值周期必须大于等于采集频率
- 取值方式必须符合数据类型要求
- 数据分类和业务分类必须从预定义选项中选择

### 4.3 数据绑定规则
- 数据源必须已配置并连接正常
- 数据点位必须存在于选定的数据源中
- 数据类型必须与变量类型匹配
- 数据绑定配置需要验证连接状态

## 5. 前置条件

### 5.1 系统前置条件
- 资产类型已定义并配置
- 数据源已配置并连接正常
- 数据点位已定义并可用
- 用户权限已配置

### 5.2 数据前置条件
- 动态变量定义已初始化
- 采集参数配置已加载
- 数据源列表已获取
- 数据点位列表已加载

### 5.3 用户前置条件
- 用户已登录系统
- 用户具有动态变量配置权限
- 用户具有数据绑定配置权限
- 用户具有批量操作权限

## 6. 字段说明

### 6.1 动态变量字段

| 字段名 | 类型 | 必填 | 说明 | 示例值 |
|--------|------|------|------|--------|
| id | String | 是 | 变量唯一标识 | variable_1234567890 |
| name | String | 是 | 变量名称 | 温度 |
| code | String | 是 | 变量编码 | temperature |
| type | String | 是 | 数据类型 | 数值 |
| unit | String | 否 | 单位 | ℃ |
| precision | Number | 否 | 精度 | 2 |
| frequency | String | 是 | 采集频率 | 30秒 |
| valueCycle | String | 是 | 取值周期 | 1分钟 |
| valueMethod | String | 是 | 取值方式 | 实时值 |
| dataCategory | String | 否 | 数据分类 | 工艺参数 |
| businessCategory | String | 否 | 业务分类 | 生产监控 |
| description | String | 否 | 变量描述 | 设备运行温度 |
| dataBinding | Object | 否 | 数据绑定配置 | {dataSource: "OPC", point: "TEMP001"} |
| status | String | 是 | 变量状态 | active/inactive |

### 6.2 数据类型枚举

| 类型值 | 显示名称 | 说明 | 支持单位 |
|--------|----------|------|----------|
| 数值 | 数值 | 数字类型 | 支持各种计量单位 |
| 字符串 | 字符串 | 文本类型 | 无单位 |
| 布尔值 | 布尔值 | 布尔类型 | 无单位 |
| 枚举 | 枚举 | 枚举类型 | 无单位 |
| 日期 | 日期 | 日期类型 | 无单位 |
| 日期时间 | 日期时间 | 日期时间类型 | 无单位 |

### 6.3 采集频率枚举

| 频率值 | 显示名称 | 说明 |
|--------|----------|------|
| 1秒 | 1秒 | 每秒采集一次 |
| 5秒 | 5秒 | 每5秒采集一次 |
| 10秒 | 10秒 | 每10秒采集一次 |
| 30秒 | 30秒 | 每30秒采集一次 |
| 1分钟 | 1分钟 | 每分钟采集一次 |
| 5分钟 | 5分钟 | 每5分钟采集一次 |
| 10分钟 | 10分钟 | 每10分钟采集一次 |
| 30分钟 | 30分钟 | 每30分钟采集一次 |
| 1小时 | 1小时 | 每小时采集一次 |
| 1天 | 1天 | 每天采集一次 |

### 6.4 取值方式枚举

| 方式值 | 显示名称 | 说明 | 适用类型 |
|--------|----------|------|----------|
| 实时值 | 实时值 | 获取最新实时数据 | 所有类型 |
| 平均值 | 平均值 | 计算周期内平均值 | 数值类型 |
| 最大值 | 最大值 | 获取周期内最大值 | 数值类型 |
| 最小值 | 最小值 | 获取周期内最小值 | 数值类型 |
| 累计值 | 累计值 | 计算周期内累计值 | 数值类型 |
| 变化率 | 变化率 | 计算数据变化率 | 数值类型 | 