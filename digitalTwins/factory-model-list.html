<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å·¥å‚æ¨¡å‹åˆ—è¡¨ - æ•°å­—å­ªç”Ÿå¹³å°</title>
    <link rel="stylesheet" href="assets/element-ui.css">
    <style>
        /* å…¨å±€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f7fa;
            color: #303133;
        }

        /* é¡µé¢å®¹å™¨ */
        .factory-model-list-container {
            min-height: 100vh;
            background-color: #f5f7fa;
        }

        /* ç²˜æ€§å¤´éƒ¨ */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 1000;
            background-color: #fff;
            border-bottom: 1px solid #e4e7ed;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            padding: 16px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .page-title {
            font-size: 20px;
            font-weight: 600;
            color: #303133;
        }

        .page-description {
            font-size: 14px;
            color: #606266;
            margin-left: 16px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px;
        }

        /* æœç´¢å’Œç­›é€‰åŒºåŸŸ */
        .search-filter-section {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 24px;
        }

        .search-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e4e7ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-title {
            font-size: 16px;
            font-weight: 600;
            color: #303133;
        }

        .search-toggle {
            color: #409eff;
            cursor: pointer;
            font-size: 14px;
        }

        .search-content {
            padding: 24px;
            border-bottom: 1px solid #e4e7ed;
        }

        .search-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .search-row:last-child {
            margin-bottom: 0;
        }

        .search-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            padding-top: 16px;
            border-top: 1px solid #e4e7ed;
        }

        /* åˆ—è¡¨å†…å®¹åŒºåŸŸ */
        .list-content {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .list-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e4e7ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .list-title {
            font-size: 16px;
            font-weight: 600;
            color: #303133;
        }

        .list-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .list-toolbar {
            padding: 16px 24px;
            border-bottom: 1px solid #e4e7ed;
            background-color: #fafafa;
            display: flex;
            gap: 12px;
            align-items: center;
            justify-content: space-between;
        }

        .toolbar-left {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .toolbar-right {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .view-mode-switch {
            display: flex;
            border: 1px solid #dcdfe6;
            border-radius: 4px;
            overflow: hidden;
        }

        .view-mode-btn {
            padding: 8px 12px;
            background: #fff;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }

        .view-mode-btn.active {
            background: #409eff;
            color: #fff;
        }

        .view-mode-btn:hover:not(.active) {
            background: #f5f7fa;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .el-table {
            border-radius: 0;
        }

        .el-table th {
            background-color: #fafafa;
            color: #606266;
            font-weight: 500;
        }

        .el-table td {
            padding: 12px 0;
        }

        /* çŠ¶æ€æ ‡ç­¾ */
        .status-tag {
            display: inline-flex;
            align-items: center;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-enabled {
            background-color: #f0f9ff;
            color: #0369a1;
        }

        .status-disabled {
            background-color: #fef2f2;
            color: #dc2626;
        }

        .status-draft {
            background-color: #fef3c7;
            color: #d97706;
        }

        /* å¡ç‰‡è§†å›¾æ ·å¼ */
        .card-view {
            padding: 24px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .model-card {
            border: 1px solid #e4e7ed;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s;
            background-color: #fff;
            cursor: pointer;
        }

        .model-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .model-card.selected {
            border-color: #409eff;
            box-shadow: 0 0 0 2px rgba(64, 158, 255, 0.2);
        }

        .card-header {
            padding: 16px;
            border-bottom: 1px solid #e4e7ed;
            background-color: #fafafa;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: #303133;
            margin-bottom: 4px;
        }

        .card-subtitle {
            font-size: 12px;
            color: #909399;
        }

        .card-content {
            padding: 16px;
        }

        .card-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 16px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .info-label {
            font-size: 12px;
            color: #909399;
        }

        .info-value {
            font-size: 14px;
            color: #303133;
            font-weight: 500;
        }

        .card-description {
            font-size: 14px;
            color: #606266;
            line-height: 1.5;
            margin-bottom: 16px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        /* åˆ†é¡µæ ·å¼ */
        .pagination-section {
            padding: 20px 24px;
            border-top: 1px solid #e4e7ed;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .pagination-info {
            font-size: 14px;
            color: #606266;
        }

        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #909399;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 14px;
            margin-bottom: 16px;
        }

                 /* å¯¼å…¥å¯¹è¯æ¡†æ ·å¼ */
         .import-form {
             padding: 20px 0;
         }
         
         .upload-demo {
             width: 100%;
         }
         
         .dialog-footer {
             text-align: right;
         }
         
         /* å“åº”å¼è®¾è®¡ */
         @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }

            .header-actions {
                width: 100%;
                justify-content: flex-end;
            }

            .search-row {
                grid-template-columns: 1fr;
            }

            .card-view {
                grid-template-columns: 1fr;
            }

            .list-toolbar {
                flex-direction: column;
                gap: 16px;
                align-items: stretch;
            }

            .toolbar-left,
            .toolbar-right {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div id="app" class="factory-model-list-container">
        <!-- ç²˜æ€§å¤´éƒ¨ -->
        <div class="sticky-header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="page-title">{{ pageTitle }}</h1>
                    <span class="page-description">{{ pageDescription }}</span>
                </div>
                <div class="header-actions">
                </div>
            </div>
        </div>

        <!-- ä¸»è¦å†…å®¹ -->
        <div class="main-content">
            <!-- æœç´¢å’Œç­›é€‰åŒºåŸŸ -->
            <div class="search-filter-section">
                <div class="search-header">
                    <span class="search-title">æœç´¢å’Œç­›é€‰</span>
                    <span class="search-toggle" @click="toggleSearch">
                        {{ searchExpanded ? 'æ”¶èµ·' : 'å±•å¼€' }}
                        <i :class="searchExpanded ? 'el-icon-arrow-up' : 'el-icon-arrow-down'"></i>
                    </span>
                </div>
                <div class="search-content" v-show="searchExpanded">
                    <div class="search-row">
                        <el-input 
                            v-model="searchForm.keyword" 
                            placeholder="æœç´¢æ¨¡å‹åç§°ã€æè¿°..." 
                            prefix-icon="el-icon-search"
                            clearable>
                        </el-input>
                        <el-select v-model="searchForm.status" placeholder="å¯ç”¨çŠ¶æ€" clearable>
                            <el-option label="å·²å¯ç”¨" value="enabled"></el-option>
                            <el-option label="å·²ç¦ç”¨" value="disabled"></el-option>
                            <el-option label="è‰ç¨¿" value="draft"></el-option>
                        </el-select>
                        <el-select v-model="searchForm.template" placeholder="æ¥æºæ¨¡æ¿" clearable>
                            <el-option 
                                v-for="template in templateOptions" 
                                :key="template.value" 
                                :label="template.label" 
                                :value="template.value">
                            </el-option>
                        </el-select>
                        <el-select v-model="searchForm.creator" placeholder="åˆ›å»ºäºº" clearable>
                            <el-option 
                                v-for="creator in creatorOptions" 
                                :key="creator.value" 
                                :label="creator.label" 
                                :value="creator.value">
                            </el-option>
                        </el-select>
                    </div>
                    <!-- <div class="search-row">
                        <el-date-picker
                            v-model="searchForm.createTimeRange"
                            type="daterange"
                            range-separator="è‡³"
                            start-placeholder="åˆ›å»ºå¼€å§‹æ—¥æœŸ"
                            end-placeholder="åˆ›å»ºç»“æŸæ—¥æœŸ"
                            format="yyyy-MM-dd"
                            value-format="yyyy-MM-dd">
                        </el-date-picker>
                        <el-date-picker
                            v-model="searchForm.updateTimeRange"
                            type="daterange"
                            range-separator="è‡³"
                            start-placeholder="æ›´æ–°å¼€å§‹æ—¥æœŸ"
                            end-placeholder="æ›´æ–°ç»“æŸæ—¥æœŸ"
                            format="yyyy-MM-dd"
                            value-format="yyyy-MM-dd">
                        </el-date-picker>
                    </div> -->
                    <div class="search-actions">
                        <el-button @click="resetSearch">é‡ç½®</el-button>
                        <el-button type="primary" @click="performSearch">æœç´¢</el-button>
                    </div>
                </div>
            </div>

            <!-- åˆ—è¡¨å†…å®¹åŒºåŸŸ -->
            <div class="list-content">
                <div class="list-header">
                    <h2 class="list-title">å·¥å‚æ¨¡å‹åˆ—è¡¨</h2>
                                         <div class="list-actions">
                         <el-button @click="createModel" type="primary" icon="el-icon-plus">
                             åˆ›å»ºæ¨¡å‹
                         </el-button>
                         <el-button @click="showImportDialog" icon="el-icon-upload2">
                             å¯¼å…¥æ¨¡å‹
                         </el-button>
                         <el-button @click="refreshList" icon="el-icon-refresh">
                             åˆ·æ–°
                         </el-button>
                         <el-button @click="batchDelete" icon="el-icon-delete" type="danger" :disabled="!hasSelected">
                             æ‰¹é‡åˆ é™¤
                         </el-button>
                     </div>
                </div>

                <div class="list-toolbar">
                    <div class="toolbar-left">
                        <el-button @click="selectAll" size="small">
                            {{ isAllSelected ? 'å–æ¶ˆå…¨é€‰' : 'å…¨é€‰' }}
                        </el-button>
                        <span v-if="hasSelected" style="color: #409eff; font-size: 14px;">
                            å·²é€‰æ‹© {{ selectedCount }} é¡¹
                        </span>
                    </div>
                    <div class="toolbar-right">
                        <div class="view-mode-switch">
                            <button 
                                class="view-mode-btn" 
                                :class="{ active: viewMode === 'table' }"
                                @click="viewMode = 'table'">
                                <i class="el-icon-menu"></i>
                            </button>
                            <button 
                                class="view-mode-btn" 
                                :class="{ active: viewMode === 'card' }"
                                @click="viewMode = 'card'">
                                <i class="el-icon-s-grid"></i>
                            </button>
                        </div>
                        <el-select v-model="pageSize" placeholder="æ¯é¡µæ˜¾ç¤º" size="small" style="width: 100px;">
                            <el-option label="10æ¡/é¡µ" :value="10"></el-option>
                            <el-option label="20æ¡/é¡µ" :value="20"></el-option>
                            <el-option label="50æ¡/é¡µ" :value="50"></el-option>
                        </el-select>
                    </div>
                </div>

                <!-- è¡¨æ ¼è§†å›¾ -->
                <div v-if="viewMode === 'table'">
                    <el-table 
                        :data="filteredModels" 
                        @selection-change="handleSelectionChange"
                        style="width: 100%">
                        <el-table-column type="selection" width="55"></el-table-column>
                        <el-table-column prop="name" label="æ¨¡å‹åç§°" min-width="200">
                            <template slot-scope="scope">
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <i class="el-icon-office-building" style="color: #409eff;"></i>
                                    <span style="font-weight: 500;">{{ scope.row.name }}</span>
                                </div>
                            </template>
                        </el-table-column>
                        <el-table-column prop="description" label="æè¿°" min-width="300">
                            <template slot-scope="scope">
                                <span style="color: #606266;">{{ scope.row.description }}</span>
                            </template>
                        </el-table-column>
                        <el-table-column prop="templateName" label="æ¥æºæ¨¡æ¿" width="150">
                            <template slot-scope="scope">
                                <el-tag size="small" type="info">{{ scope.row.templateName }}</el-tag>
                            </template>
                        </el-table-column>
                        <el-table-column prop="status" label="çŠ¶æ€" width="100">
                            <template slot-scope="scope">
                                <span class="status-tag" :class="getStatusClass(scope.row.status)">
                                    {{ getStatusText(scope.row.status) }}
                                </span>
                            </template>
                        </el-table-column>
                        <el-table-column prop="creator" label="åˆ›å»ºäºº" width="100"></el-table-column>
                        <el-table-column prop="createTime" label="åˆ›å»ºæ—¶é—´" width="160"></el-table-column>
                        <el-table-column prop="updateTime" label="æ›´æ–°æ—¶é—´" width="160"></el-table-column>
                        <el-table-column label="æ“ä½œ" width="180" fixed="right">
                            <template slot-scope="scope">
                                <div style="display: flex; gap: 8px; align-items: center; white-space: nowrap;">
                                    <el-button 
                                        type="text" 
                                        size="mini" 
                                        @click="viewModel(scope.row)"
                                        title="æŸ¥çœ‹æ¨¡å‹è¯¦æƒ…">
                                        <i class="el-icon-view"></i>
                                    </el-button>
                                    <el-button 
                                        type="text" 
                                        size="mini" 
                                        @click="editModel(scope.row)"
                                        title="ç¼–è¾‘æ¨¡å‹ä¿¡æ¯">
                                        <i class="el-icon-edit"></i>
                                    </el-button>
                                    <el-button 
                                        type="text" 
                                        size="mini" 
                                        @click="copyModel(scope.row)"
                                        title="å¤åˆ¶æ¨¡å‹">
                                        <i class="el-icon-document-copy"></i>
                                    </el-button>
                                    <el-button 
                                        type="text" 
                                        size="mini" 
                                        @click="toggleModelStatus(scope.row)"
                                        :style="{ color: scope.row.status === 'enabled' ? '#f56c6c' : '#67c23a' }"
                                        :title="scope.row.status === 'enabled' ? 'ç¦ç”¨æ¨¡å‹' : 'å¯ç”¨æ¨¡å‹'">
                                        <i :class="scope.row.status === 'enabled' ? 'el-icon-close' : 'el-icon-check'"></i>
                                    </el-button>
                                    <el-button 
                                        type="text" 
                                        size="mini" 
                                        @click="deleteModel(scope.row)"
                                        :disabled="scope.row.status === 'enabled'"
                                        :style="{ color: scope.row.status === 'enabled' ? '#c0c4cc' : '#f56c6c' }"
                                        :title="scope.row.status === 'enabled' ? 'å·²å¯ç”¨çš„æ¨¡å‹ä¸èƒ½åˆ é™¤' : 'åˆ é™¤æ¨¡å‹'">
                                        <i class="el-icon-delete"></i>
                                    </el-button>
                                </div>
                            </template>
                        </el-table-column>
                    </el-table>
                </div>

                <!-- å¡ç‰‡è§†å›¾ -->
                <div v-else class="card-view">
                    <div 
                        v-for="model in filteredModels" 
                        :key="model.id"
                        class="model-card"
                        :class="{ selected: selectedModels.includes(model.id) }"
                        @click="toggleModelSelection(model.id)">
                        <div class="card-header">
                            <div class="card-title">{{ model.name }}</div>
                            <div class="card-subtitle">{{ model.templateName }}</div>
                        </div>
                        <div class="card-content">
                            <div class="card-description">{{ model.description }}</div>
                            <div class="card-info">
                                <div class="info-item">
                                    <span class="info-label">çŠ¶æ€</span>
                                    <span class="status-tag" :class="getStatusClass(model.status)">
                                        {{ getStatusText(model.status) }}
                                    </span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">åˆ›å»ºäºº</span>
                                    <span class="info-value">{{ model.creator }}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">åˆ›å»ºæ—¶é—´</span>
                                    <span class="info-value">{{ model.createTime }}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">æ›´æ–°æ—¶é—´</span>
                                    <span class="info-value">{{ model.updateTime }}</span>
                                </div>
                            </div>
                            <div class="card-actions">
                                <el-button 
                                    type="text" 
                                    size="mini" 
                                    @click.stop="viewModel(model)"
                                    title="æŸ¥çœ‹æ¨¡å‹è¯¦æƒ…">
                                    <i class="el-icon-view"></i>
                                </el-button>
                                <el-button 
                                    type="text" 
                                    size="mini" 
                                    @click.stop="editModel(model)"
                                    title="ç¼–è¾‘æ¨¡å‹ä¿¡æ¯">
                                    <i class="el-icon-edit"></i>
                                </el-button>
                                <el-button 
                                    type="text" 
                                    size="mini" 
                                    @click.stop="copyModel(model)"
                                    title="å¤åˆ¶æ¨¡å‹">
                                    <i class="el-icon-document-copy"></i>
                                </el-button>
                                <el-button 
                                    type="text" 
                                    size="mini" 
                                    @click.stop="toggleModelStatus(model)"
                                    :style="{ color: model.status === 'enabled' ? '#f56c6c' : '#67c23a' }"
                                    :title="model.status === 'enabled' ? 'ç¦ç”¨æ¨¡å‹' : 'å¯ç”¨æ¨¡å‹'">
                                    <i :class="model.status === 'enabled' ? 'el-icon-close' : 'el-icon-check'"></i>
                                </el-button>
                                <el-button 
                                    type="text" 
                                    size="mini" 
                                    @click.stop="deleteModel(model)"
                                    :disabled="model.status === 'enabled'"
                                    :style="{ color: model.status === 'enabled' ? '#c0c4cc' : '#f56c6c' }"
                                    :title="model.status === 'enabled' ? 'å·²å¯ç”¨çš„æ¨¡å‹ä¸èƒ½åˆ é™¤' : 'åˆ é™¤æ¨¡å‹'">
                                    <i class="el-icon-delete"></i>
                                </el-button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ç©ºçŠ¶æ€ -->
                <div v-if="filteredModels.length === 0" class="empty-state">
                    <div class="empty-state-icon">ğŸ­</div>
                    <div class="empty-state-text">æš‚æ— å·¥å‚æ¨¡å‹æ•°æ®</div>
                    <el-button type="primary" @click="createModel">
                        åˆ›å»ºç¬¬ä¸€ä¸ªæ¨¡å‹
                    </el-button>
                </div>

                <!-- åˆ†é¡µ -->
                <div v-if="filteredModels.length > 0" class="pagination-section">
                    <div class="pagination-info">
                        å…± {{ totalCount }} æ¡è®°å½•ï¼Œå½“å‰æ˜¾ç¤ºç¬¬ {{ currentPage }} é¡µ
                    </div>
                    <el-pagination
                        @size-change="handleSizeChange"
                        @current-change="handleCurrentChange"
                        :current-page="currentPage"
                        :page-sizes="[10, 20, 50]"
                        :page-size="pageSize"
                        layout="total, sizes, prev, pager, next, jumper"
                        :total="totalCount">
                    </el-pagination>
                </div>
            </div>
        </div>
    </div>

    <!-- å¯¼å…¥æ¨¡å‹å¯¹è¯æ¡† -->
    <el-dialog
        title="å¯¼å…¥å·¥å‚æ¨¡å‹"
        :visible.sync="importDialogVisible"
        width="500px"
        :before-close="closeImportDialog">
        <div class="import-form">
            <el-form :model="importForm" label-width="100px">
                <el-form-item label="å¯¼å…¥æ ¼å¼">
                    <el-radio-group v-model="importForm.format">
                        <el-radio label="json">JSONæ ¼å¼</el-radio>
                        <el-radio label="excel">Excelæ ¼å¼</el-radio>
                    </el-radio-group>
                </el-form-item>
                <el-form-item label="é€‰æ‹©æ–‡ä»¶">
                    <el-upload
                        class="upload-demo"
                        drag
                        :action="uploadAction"
                        :before-upload="beforeUpload"
                        :on-success="onUploadSuccess"
                        :on-error="onUploadError"
                        :file-list="fileList"
                        :limit="1"
                        accept=".json,.xlsx,.xls">
                        <i class="el-icon-upload"></i>
                        <div class="el-upload__text">å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em></div>
                        <div class="el-upload__tip" slot="tip">
                            æ”¯æŒ {{ importForm.format === 'json' ? '.json' : '.xlsx, .xls' }} æ ¼å¼æ–‡ä»¶
                        </div>
                    </el-upload>
                </el-form-item>
            </el-form>
        </div>
        <div slot="footer" class="dialog-footer">
            <el-button @click="closeImportDialog">å–æ¶ˆ</el-button>
            <el-button type="primary" @click="confirmImport" :disabled="!importForm.file">ç¡®å®šå¯¼å…¥</el-button>
        </div>
    </el-dialog>

    <!-- å¼•å…¥Vueå’ŒElement UI -->
    <script src="assets/vue.js"></script>
    <script src="assets/element-ui.js"></script>
    
    <script>
        new Vue({
            el: '#app',
            data: {
                // é¡µé¢ä¿¡æ¯
                pageTitle: 'å·¥å‚æ¨¡å‹ç®¡ç†',
                pageDescription: 'ç®¡ç†å·¥å‚æ•°å­—å­ªç”Ÿæ¨¡å‹ï¼Œæ”¯æŒåˆ›å»ºã€ç¼–è¾‘ã€å¤åˆ¶å’Œåˆ é™¤æ“ä½œ',
                
                // è§†å›¾æ¨¡å¼
                viewMode: 'table', // 'table' æˆ– 'card'
                
                // æœç´¢ç›¸å…³
                searchExpanded: false,
                searchForm: {
                    keyword: '',
                    status: '',
                    template: '',
                    creator: '',
                    createTimeRange: [],
                    updateTimeRange: []
                },
                
                // åˆ†é¡µç›¸å…³
                currentPage: 1,
                pageSize: 20,
                totalCount: 0,
                
                // é€‰æ‹©ç›¸å…³
                selectedModels: [],
                
                // å¯¼å…¥ç›¸å…³
                importDialogVisible: false,
                importForm: {
                    format: 'json',
                    file: null
                },
                fileList: [],
                uploadAction: '#', // å®é™…é¡¹ç›®ä¸­åº”è¯¥æŒ‡å‘çœŸå®çš„ä¸Šä¼ æ¥å£
                
                // æ¨¡å‹æ•°æ®
                models: [
                    {
                        id: 'model-1',
                        name: 'åä¸œæ°´æ³¥ç”Ÿäº§åŸºåœ°',
                        description: 'åä¸œåœ°åŒºä¸»è¦æ°´æ³¥ç”Ÿäº§åŸºåœ°ï¼Œå¹´äº§æ°´æ³¥500ä¸‡å¨ï¼ŒåŒ…å«å®Œæ•´çš„ç†Ÿæ–™ç”Ÿäº§çº¿ã€ç²‰ç£¨ç³»ç»Ÿå’ŒåŒ…è£…ç³»ç»Ÿã€‚',
                        templateName: 'æ ‡å‡†æ°´æ³¥å·¥å‚æ¨¡æ¿',
                        status: 'enabled',
                        creator: 'å¼ å·¥ç¨‹å¸ˆ',
                        createTime: '2024-01-15 10:30:00',
                        updateTime: '2024-01-20 14:20:00',
                        nodeCount: 15,
                        assetCount: 16
                    },
                    {
                        id: 'model-2',
                        name: 'åå—æ™ºèƒ½æ°´æ³¥å‚',
                        description: 'åå—åœ°åŒºæ™ºèƒ½åŒ–æ°´æ³¥å·¥å‚ï¼Œé‡‡ç”¨å…ˆè¿›çš„DCSæ§åˆ¶ç³»ç»Ÿå’Œè‡ªåŠ¨åŒ–è®¾å¤‡ï¼Œå¹´äº§æ°´æ³¥300ä¸‡å¨ã€‚',
                        templateName: 'æ™ºèƒ½æ°´æ³¥å·¥å‚æ¨¡æ¿',
                        status: 'enabled',
                        creator: 'ææŠ€æœ¯å‘˜',
                        createTime: '2024-01-10 09:15:00',
                        updateTime: '2024-01-18 16:45:00',
                        nodeCount: 12,
                        assetCount: 14
                    },
                    {
                        id: 'model-3',
                        name: 'ååŒ—ç»¿è‰²æ°´æ³¥å‚',
                        description: 'ååŒ—åœ°åŒºç¯ä¿å‹æ°´æ³¥å·¥å‚ï¼Œæ³¨é‡èŠ‚èƒ½å‡æ’å’Œå¯æŒç»­å‘å±•ï¼Œé‡‡ç”¨ä½™çƒ­å‘ç”µå’Œè„±ç¡æŠ€æœ¯ã€‚',
                        templateName: 'ç»¿è‰²æ°´æ³¥å·¥å‚æ¨¡æ¿',
                        status: 'draft',
                        creator: 'ç‹ç¯ä¿å¸ˆ',
                        createTime: '2024-01-12 11:00:00',
                        updateTime: '2024-01-19 10:30:00',
                        nodeCount: 8,
                        assetCount: 10
                    },
                    {
                        id: 'model-4',
                        name: 'è¥¿éƒ¨æ°´æ³¥ç”Ÿäº§åŸºåœ°',
                        description: 'è¥¿éƒ¨åœ°åŒºæ°´æ³¥ç”Ÿäº§åŸºåœ°ï¼Œå¹´äº§æ°´æ³¥200ä¸‡å¨ï¼Œé‡‡ç”¨æ–°å‹å¹²æ³•å·¥è‰ºï¼Œæ³¨é‡ç¯ä¿å’ŒèŠ‚èƒ½ã€‚',
                        templateName: 'æ–°å‹å¹²æ³•æ°´æ³¥æ¨¡æ¿',
                        status: 'disabled',
                        creator: 'èµµå·¥ç¨‹å¸ˆ',
                        createTime: '2024-01-08 15:30:00',
                        updateTime: '2024-01-16 13:20:00',
                        nodeCount: 10,
                        assetCount: 12
                    },
                    {
                        id: 'model-5',
                        name: 'ä¸œåŒ—é‡å·¥ä¸šæ°´æ³¥å‚',
                        description: 'ä¸œåŒ—åœ°åŒºé‡å·¥ä¸šæ°´æ³¥å·¥å‚ï¼Œä¸“æ³¨äºé«˜æ ‡å·æ°´æ³¥ç”Ÿäº§ï¼ŒåŒ…å«å¤§å‹å›è½¬çª‘å’Œç²‰ç£¨è®¾å¤‡ã€‚',
                        templateName: 'é‡å·¥ä¸šæ°´æ³¥æ¨¡æ¿',
                        status: 'enabled',
                        creator: 'å­™æŠ€æœ¯å‘˜',
                        createTime: '2024-01-05 08:45:00',
                        updateTime: '2024-01-17 17:10:00',
                        nodeCount: 20,
                        assetCount: 18
                    }
                ],
                
                // é€‰é¡¹æ•°æ®
                templateOptions: [
                    { label: 'æ ‡å‡†æ°´æ³¥å·¥å‚æ¨¡æ¿', value: 'æ ‡å‡†æ°´æ³¥å·¥å‚æ¨¡æ¿' },
                    { label: 'æ™ºèƒ½æ°´æ³¥å·¥å‚æ¨¡æ¿', value: 'æ™ºèƒ½æ°´æ³¥å·¥å‚æ¨¡æ¿' },
                    { label: 'ç»¿è‰²æ°´æ³¥å·¥å‚æ¨¡æ¿', value: 'ç»¿è‰²æ°´æ³¥å·¥å‚æ¨¡æ¿' },
                    { label: 'æ–°å‹å¹²æ³•æ°´æ³¥æ¨¡æ¿', value: 'æ–°å‹å¹²æ³•æ°´æ³¥æ¨¡æ¿' },
                    { label: 'é‡å·¥ä¸šæ°´æ³¥æ¨¡æ¿', value: 'é‡å·¥ä¸šæ°´æ³¥æ¨¡æ¿' }
                ],
                creatorOptions: [
                    { label: 'å¼ å·¥ç¨‹å¸ˆ', value: 'å¼ å·¥ç¨‹å¸ˆ' },
                    { label: 'ææŠ€æœ¯å‘˜', value: 'ææŠ€æœ¯å‘˜' },
                    { label: 'ç‹ç¯ä¿å¸ˆ', value: 'ç‹ç¯ä¿å¸ˆ' },
                    { label: 'èµµå·¥ç¨‹å¸ˆ', value: 'èµµå·¥ç¨‹å¸ˆ' },
                    { label: 'å­™æŠ€æœ¯å‘˜', value: 'å­™æŠ€æœ¯å‘˜' }
                ]
            },
            computed: {
                // è¿‡æ»¤åçš„æ¨¡å‹åˆ—è¡¨
                filteredModels() {
                    let result = this.models;
                    
                    // å…³é”®è¯æœç´¢
                    if (this.searchForm.keyword) {
                        const keyword = this.searchForm.keyword.toLowerCase();
                        result = result.filter(model => 
                            model.name.toLowerCase().includes(keyword) ||
                            model.description.toLowerCase().includes(keyword) ||
                            model.templateName.toLowerCase().includes(keyword)
                        );
                    }
                    
                    // çŠ¶æ€ç­›é€‰
                    if (this.searchForm.status) {
                        result = result.filter(model => model.status === this.searchForm.status);
                    }
                    
                    // æ¨¡æ¿ç­›é€‰
                    if (this.searchForm.template) {
                        result = result.filter(model => model.templateName === this.searchForm.template);
                    }
                    
                    // åˆ›å»ºäººç­›é€‰
                    if (this.searchForm.creator) {
                        result = result.filter(model => model.creator === this.searchForm.creator);
                    }
                    
                    // åˆ›å»ºæ—¶é—´èŒƒå›´ç­›é€‰
                    if (this.searchForm.createTimeRange && this.searchForm.createTimeRange.length === 2) {
                        const [startDate, endDate] = this.searchForm.createTimeRange;
                        result = result.filter(model => {
                            const createDate = model.createTime.split(' ')[0];
                            return createDate >= startDate && createDate <= endDate;
                        });
                    }
                    
                    // æ›´æ–°æ—¶é—´èŒƒå›´ç­›é€‰
                    if (this.searchForm.updateTimeRange && this.searchForm.updateTimeRange.length === 2) {
                        const [startDate, endDate] = this.searchForm.updateTimeRange;
                        result = result.filter(model => {
                            const updateDate = model.updateTime.split(' ')[0];
                            return updateDate >= startDate && updateDate <= endDate;
                        });
                    }
                    
                    this.totalCount = result.length;
                    return result;
                },
                
                // æ˜¯å¦æœ‰é€‰ä¸­çš„æ¨¡å‹
                hasSelected() {
                    return this.selectedModels.length > 0;
                },
                
                // é€‰ä¸­çš„æ•°é‡
                selectedCount() {
                    return this.selectedModels.length;
                },
                
                // æ˜¯å¦å…¨é€‰
                isAllSelected() {
                    return this.filteredModels.length > 0 && this.selectedModels.length === this.filteredModels.length;
                }
            },
            methods: {
                // åˆ‡æ¢æœç´¢å±•å¼€çŠ¶æ€
                toggleSearch() {
                    this.searchExpanded = !this.searchExpanded;
                },
                
                // é‡ç½®æœç´¢æ¡ä»¶
                resetSearch() {
                    this.searchForm = {
                        keyword: '',
                        status: '',
                        template: '',
                        creator: '',
                        createTimeRange: [],
                        updateTimeRange: []
                    };
                },
                
                // æ‰§è¡Œæœç´¢
                performSearch() {
                    this.currentPage = 1;
                    this.$message.success('æœç´¢å®Œæˆ');
                },
                
                // åˆ·æ–°åˆ—è¡¨
                refreshList() {
                    this.$message.success('åˆ—è¡¨å·²åˆ·æ–°');
                },
                
                // åˆ›å»ºæ¨¡å‹
                createModel() {
                    this.$message.info('è·³è½¬åˆ°åˆ›å»ºæ¨¡å‹é¡µé¢...');
                    // è¿™é‡Œå¯ä»¥è·³è½¬åˆ°åˆ›å»ºé¡µé¢æˆ–æ‰“å¼€åˆ›å»ºå¯¹è¯æ¡†
                },
                
                // æ˜¾ç¤ºå¯¼å…¥å¯¹è¯æ¡†
                showImportDialog() {
                    this.importDialogVisible = true;
                    this.importForm = {
                        format: 'json',
                        file: null
                    };
                    this.fileList = [];
                },
                
                // å…³é—­å¯¼å…¥å¯¹è¯æ¡†
                closeImportDialog() {
                    this.importDialogVisible = false;
                    this.importForm = {
                        format: 'json',
                        file: null
                    };
                    this.fileList = [];
                },
                
                // ä¸Šä¼ å‰éªŒè¯
                beforeUpload(file) {
                    const isValidFormat = this.importForm.format === 'json' 
                        ? file.name.endsWith('.json')
                        : file.name.endsWith('.xlsx') || file.name.endsWith('.xls');
                    
                    if (!isValidFormat) {
                        this.$message.error(`è¯·é€‰æ‹©${this.importForm.format === 'json' ? 'JSON' : 'Excel'}æ ¼å¼çš„æ–‡ä»¶`);
                        return false;
                    }
                    
                    this.importForm.file = file;
                    return false; // é˜»æ­¢è‡ªåŠ¨ä¸Šä¼ ï¼Œæ‰‹åŠ¨å¤„ç†
                },
                
                // ä¸Šä¼ æˆåŠŸå›è°ƒ
                onUploadSuccess(response, file, fileList) {
                    this.$message.success('æ–‡ä»¶ä¸Šä¼ æˆåŠŸ');
                },
                
                // ä¸Šä¼ å¤±è´¥å›è°ƒ
                onUploadError(err, file, fileList) {
                    this.$message.error('æ–‡ä»¶ä¸Šä¼ å¤±è´¥');
                },
                
                // ç¡®è®¤å¯¼å…¥
                confirmImport() {
                    if (!this.importForm.file) {
                        this.$message.warning('è¯·å…ˆé€‰æ‹©è¦å¯¼å…¥çš„æ–‡ä»¶');
                        return;
                    }
                    
                    this.$message.success(`æ­£åœ¨å¯¼å…¥${this.importForm.format.toUpperCase()}æ ¼å¼çš„æ¨¡å‹æ–‡ä»¶...`);
                    this.closeImportDialog();
                    // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„å¯¼å…¥API
                },
                
                // æŸ¥çœ‹æ¨¡å‹
                viewModel(model) {
                    this.$message.info(`æŸ¥çœ‹æ¨¡å‹ï¼š${model.name}`);
                    // è·³è½¬åˆ°æ¨¡å‹è¯¦æƒ…é¡µé¢
                    window.location.href = `factory-model-management.html?id=${model.id}`;
                },
                
                // ç¼–è¾‘æ¨¡å‹
                editModel(model) {
                    this.$message.info(`ç¼–è¾‘æ¨¡å‹ï¼š${model.name}`);
                    // è·³è½¬åˆ°æ¨¡å‹ç¼–è¾‘é¡µé¢
                    window.location.href = `factory-model-management.html?id=${model.id}&mode=edit`;
                },
                
                // å¤åˆ¶æ¨¡å‹
                copyModel(model) {
                    this.$confirm(`ç¡®å®šè¦å¤åˆ¶æ¨¡å‹"${model.name}"å—ï¼Ÿ`, 'ç¡®è®¤å¤åˆ¶', {
                        confirmButtonText: 'ç¡®å®š',
                        cancelButtonText: 'å–æ¶ˆ',
                        type: 'info'
                    }).then(() => {
                        // å¤åˆ¶æ¨¡å‹çš„é€»è¾‘
                        const newModel = {
                            ...model,
                            id: 'model-' + Date.now(),
                            name: model.name + '_å‰¯æœ¬',
                            status: 'draft',
                            createTime: new Date().toLocaleString(),
                            updateTime: new Date().toLocaleString()
                        };
                        this.models.unshift(newModel);
                        this.$message.success('æ¨¡å‹å¤åˆ¶æˆåŠŸï¼Œæ­£åœ¨è·³è½¬åˆ°ç¼–è¾‘é¡µé¢...');
                        
                        // è‡ªåŠ¨è·³è½¬åˆ°è¯¦æƒ…é¡µé¢å¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼
                        setTimeout(() => {
                            window.location.href = `factory-model-management.html?id=${newModel.id}&mode=edit`;
                        }, 1000);
                    }).catch(() => {
                        this.$message.info('å·²å–æ¶ˆå¤åˆ¶');
                    });
                },
                
                // åˆ‡æ¢æ¨¡å‹çŠ¶æ€
                toggleModelStatus(model) {
                    const newStatus = model.status === 'enabled' ? 'disabled' : 'enabled';
                    const statusText = newStatus === 'enabled' ? 'å¯ç”¨' : 'ç¦ç”¨';
                    
                    this.$confirm(`ç¡®å®šè¦${statusText}æ¨¡å‹"${model.name}"å—ï¼Ÿ`, 'ç¡®è®¤æ“ä½œ', {
                        confirmButtonText: 'ç¡®å®š',
                        cancelButtonText: 'å–æ¶ˆ',
                        type: 'warning'
                    }).then(() => {
                        model.status = newStatus;
                        model.updateTime = new Date().toLocaleString();
                        this.$message.success(`æ¨¡å‹å·²${statusText}`);
                    }).catch(() => {
                        this.$message.info('å·²å–æ¶ˆæ“ä½œ');
                    });
                },
                
                // åˆ é™¤æ¨¡å‹
                deleteModel(model) {
                    // æ£€æŸ¥æ¨¡å‹çŠ¶æ€ï¼Œå·²å¯ç”¨çš„æ¨¡å‹ä¸èƒ½åˆ é™¤
                    if (model.status === 'enabled') {
                        this.$message.warning('å·²å¯ç”¨çš„å·¥å‚æ¨¡å‹ä¸èƒ½è¢«åˆ é™¤ï¼Œè¯·å…ˆç¦ç”¨è¯¥æ¨¡å‹');
                        return;
                    }
                    
                    this.$confirm(`ç¡®å®šè¦åˆ é™¤æ¨¡å‹"${model.name}"å—ï¼Ÿåˆ é™¤åæ— æ³•æ¢å¤ã€‚`, 'ç¡®è®¤åˆ é™¤', {
                        confirmButtonText: 'ç¡®å®š',
                        cancelButtonText: 'å–æ¶ˆ',
                        type: 'warning'
                    }).then(() => {
                        const index = this.models.findIndex(m => m.id === model.id);
                        if (index > -1) {
                            this.models.splice(index, 1);
                            // ä»é€‰ä¸­åˆ—è¡¨ä¸­ç§»é™¤
                            const selectedIndex = this.selectedModels.indexOf(model.id);
                            if (selectedIndex > -1) {
                                this.selectedModels.splice(selectedIndex, 1);
                            }
                            this.$message.success('æ¨¡å‹åˆ é™¤æˆåŠŸ');
                        }
                    }).catch(() => {
                        this.$message.info('å·²å–æ¶ˆåˆ é™¤');
                    });
                },
                
                // æ‰¹é‡åˆ é™¤
                batchDelete() {
                    if (this.selectedModels.length === 0) {
                        this.$message.warning('è¯·å…ˆé€‰æ‹©è¦åˆ é™¤çš„æ¨¡å‹');
                        return;
                    }
                    
                    // æ£€æŸ¥é€‰ä¸­çš„æ¨¡å‹ä¸­æ˜¯å¦æœ‰å·²å¯ç”¨çš„æ¨¡å‹
                    const selectedModelData = this.models.filter(model => this.selectedModels.includes(model.id));
                    const enabledModels = selectedModelData.filter(model => model.status === 'enabled');
                    
                    if (enabledModels.length > 0) {
                        const enabledModelNames = enabledModels.map(model => model.name).join('ã€');
                        this.$message.warning(`ä»¥ä¸‹å·²å¯ç”¨çš„æ¨¡å‹ä¸èƒ½è¢«åˆ é™¤ï¼š${enabledModelNames}ï¼Œè¯·å…ˆç¦ç”¨è¿™äº›æ¨¡å‹`);
                        return;
                    }
                    
                    this.$confirm(`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${this.selectedModels.length} ä¸ªæ¨¡å‹å—ï¼Ÿåˆ é™¤åæ— æ³•æ¢å¤ã€‚`, 'ç¡®è®¤æ‰¹é‡åˆ é™¤', {
                        confirmButtonText: 'ç¡®å®š',
                        cancelButtonText: 'å–æ¶ˆ',
                        type: 'warning'
                    }).then(() => {
                        this.models = this.models.filter(model => !this.selectedModels.includes(model.id));
                        this.selectedModels = [];
                        this.$message.success('æ‰¹é‡åˆ é™¤æˆåŠŸ');
                    }).catch(() => {
                        this.$message.info('å·²å–æ¶ˆåˆ é™¤');
                    });
                },
                
                // å¤„ç†é€‰æ‹©å˜åŒ–
                handleSelectionChange(selection) {
                    this.selectedModels = selection.map(item => item.id);
                },
                
                // å…¨é€‰/å–æ¶ˆå…¨é€‰
                selectAll() {
                    if (this.isAllSelected) {
                        this.selectedModels = [];
                    } else {
                        this.selectedModels = this.filteredModels.map(model => model.id);
                    }
                },
                
                // åˆ‡æ¢æ¨¡å‹é€‰æ‹©ï¼ˆå¡ç‰‡è§†å›¾ï¼‰
                toggleModelSelection(modelId) {
                    const index = this.selectedModels.indexOf(modelId);
                    if (index > -1) {
                        this.selectedModels.splice(index, 1);
                    } else {
                        this.selectedModels.push(modelId);
                    }
                },
                
                // è·å–çŠ¶æ€æ ·å¼ç±»
                getStatusClass(status) {
                    switch (status) {
                        case 'enabled': return 'status-enabled';
                        case 'disabled': return 'status-disabled';
                        case 'draft': return 'status-draft';
                        default: return 'status-draft';
                    }
                },
                
                // è·å–çŠ¶æ€æ–‡æœ¬
                getStatusText(status) {
                    switch (status) {
                        case 'enabled': return 'å·²å¯ç”¨';
                        case 'disabled': return 'å·²ç¦ç”¨';
                        case 'draft': return 'è‰ç¨¿';
                        default: return 'è‰ç¨¿';
                    }
                },
                
                // å¤„ç†åˆ†é¡µå¤§å°å˜åŒ–
                handleSizeChange(size) {
                    this.pageSize = size;
                    this.currentPage = 1;
                },
                
                // å¤„ç†å½“å‰é¡µå˜åŒ–
                handleCurrentChange(page) {
                    this.currentPage = page;
                }
            },
            mounted() {
                this.totalCount = this.models.length;
                console.log('å·¥å‚æ¨¡å‹åˆ—è¡¨é¡µé¢å·²åŠ è½½');
            }
        });
    </script>
</body>
</html> 