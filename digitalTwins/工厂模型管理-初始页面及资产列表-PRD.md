# 工厂模型管理 - 初始页面及资产列表 PRD

## 功能目标

### 1.1 页面概述
提供工厂模型的整体管理界面，包括模型基本信息展示、层级结构管理、资产列表展示等功能，支持查看模式和编辑模式切换。

### 1.2 主要目标
- 展示工厂模型的基本信息和状态
- 提供层级结构的树形展示和管理
- 显示当前选中节点及其下级节点的资产列表
- 支持资产的查看、编辑、新增操作
- 提供资产搜索和过滤功能

## 功能描述

### 2.1 页面布局
页面采用左右分栏布局：
- **左侧**：层级结构树形展示区域
- **右侧**：资产列表展示区域

### 2.2 基本信息管理
- 显示工厂模型名称、模板名称、状态等信息
- 支持模型基本信息的编辑和保存
- 提供模型状态切换功能（启用/禁用）
- 支持模型导出功能

### 2.3 层级结构管理
- 树形展示工厂的层级结构
- 支持节点的展开/收起操作
- 提供节点搜索功能
- 支持节点的添加、编辑、删除、复制操作
- 支持节点拖拽排序

### 2.4 资产列表管理
- 显示当前选中节点及其下级节点的所有资产
- 支持资产的搜索和过滤
- 提供资产的查看、编辑、新增操作
- 显示资产的层级信息

## 交互说明

### 3.1 模式切换
- **查看模式**：页面默认为查看模式，所有编辑功能被禁用
- **编辑模式**：点击"编辑"按钮进入编辑模式，启用所有编辑功能
- **模式标识**：通过页面标题和按钮状态明确标识当前模式

### 3.2 层级结构交互
- **节点选择**：点击节点名称选中节点，右侧显示对应的资产列表
- **节点展开/收起**：点击节点前的箭头图标展开或收起子节点
- **节点操作**：
  - 查看模式：显示"查看节点"按钮
  - 编辑模式：显示"添加子节点"、"编辑"、"复制"、"删除"按钮
- **节点搜索**：在搜索框中输入关键词，实时过滤显示匹配的节点

### 3.3 资产列表交互
- **资产搜索**：支持按名称、型号、类别、供应商等字段搜索
- **资产操作**：
  - 查看：点击"查看"按钮进入资产详情查看模式
  - 编辑：点击"编辑"按钮进入资产详情编辑模式
  - 新增：点击"添加资产"按钮进入资产详情新增模式
- **层级显示**：资产列表中显示"层级"列，显示资产所在的层级数

### 3.4 节点弹框交互
- **添加节点**：点击"添加子节点"按钮，弹出添加节点弹框
- **编辑节点**：点击"编辑"按钮，弹出编辑节点弹框
- **查看节点**：点击"查看节点"按钮，弹出查看节点弹框
- **节点类型选择**：根据父节点类型动态过滤可选的子节点类型

## 业务规则

### 4.1 层级结构规则
- 工厂模型必须有一个根节点（工厂）
- 节点类型必须符合层级关系：
  - 工厂 → 车间/系统
  - 车间 → 产线/设备
  - 产线 → 工段/设备
  - 工段 → 设备
  - 系统 → 设备
- 设备节点不能有子节点

### 4.2 资产管理规则
- 资产必须挂载到具体的节点上
- 资产列表显示当前节点及其所有下级节点的资产
- 资产层级信息自动根据节点层级生成
- 资产操作权限根据当前页面模式确定

### 4.3 数据验证规则
- 节点名称不能为空
- 节点编码必须唯一
- 节点类型必须符合层级关系
- 资产信息必填字段不能为空

### 4.4 权限控制规则
- 查看模式：只能查看信息，不能进行编辑操作
- 编辑模式：可以进行所有编辑操作
- 节点操作权限根据当前模式动态显示

## 前置条件

### 5.1 系统要求
- 浏览器支持Vue.js 2.x
- 浏览器支持Element UI组件库
- 网络连接正常，能够访问相关API

### 5.2 数据要求
- 工厂模型数据已存在
- 层级结构数据完整
- 资产数据已配置

### 5.3 权限要求
- 用户具有工厂模型查看权限
- 编辑模式需要额外的编辑权限

## 字段说明

### 6.1 模型基本信息字段
| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 模型名称 | 字符串 | 是 | 工厂模型的名称 |
| 模型描述 | 文本 | 否 | 工厂模型的详细描述 |
| 模板名称 | 字符串 | 是 | 基于的模板名称 |
| 创建时间 | 日期时间 | 是 | 模型创建时间 |
| 创建人 | 字符串 | 是 | 模型创建人 |
| 状态 | 枚举 | 是 | 模型状态：启用/禁用/草稿 |

### 6.2 节点信息字段
| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 节点名称 | 字符串 | 是 | 节点的显示名称 |
| 节点编码 | 字符串 | 是 | 节点的唯一编码 |
| 节点类型 | 枚举 | 是 | 节点类型：工厂/车间/产线/工段/设备/系统 |
| 描述 | 文本 | 否 | 节点的详细描述 |
| 资产类型 | 字符串 | 否 | 节点对应的资产类型（自动生成） |
| 允许子节点类型 | 字符串 | 否 | 允许的子节点类型（自动生成） |

### 6.3 资产信息字段
| 字段名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 资产名称 | 字符串 | 是 | 资产的显示名称 |
| 资产编码 | 字符串 | 是 | 资产的唯一编码 |
| 资产类型 | 字符串 | 是 | 资产的类型 |
| 型号 | 字符串 | 否 | 资产的型号 |
| 类别 | 字符串 | 否 | 资产的分类 |
| 供应商 | 字符串 | 否 | 资产供应商 |
| 制造商 | 字符串 | 否 | 资产制造商 |
| 安装日期 | 日期 | 否 | 资产安装日期 |
| 状态 | 字符串 | 是 | 资产运行状态 |
| 接入状态 | 布尔值 | 是 | 是否已接入系统 |
| 层级 | 字符串 | 是 | 资产所在层级（L1/L2等） | 