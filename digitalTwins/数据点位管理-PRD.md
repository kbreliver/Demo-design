# 数据点位管理 - 产品需求文档 (PRD)

## 1. 功能目标

### 1.1 主要目标
- 提供统一的数据点位管理界面，支持对工厂内所有数据点位的集中管理
- 实现数据点位的增删改查、状态监控、异常规则配置等核心功能
- 支持数据点位的层级结构展示，便于用户快速定位和管理
- 提供灵活的筛选和搜索功能，提高数据点位查找效率
- 集成异常检测规则配置，支持多种异常检测方法

### 1.2 次要目标
- 支持数据点位的批量操作，提高管理效率
- 提供数据点位的实时状态监控
- 支持数据点位的建模参与状态管理
- 提供友好的用户界面和交互体验

## 2. 功能描述

### 2.1 数据点位列表管理
- **层级展示**: 以树形结构展示数据点位的层级关系
- **列表视图**: 提供表格形式的数据点位列表，支持分页显示
- **状态显示**: 实时显示数据点位的启停状态、最新数据、异常规则数量等
- **操作功能**: 支持查看详情、编辑、配置规则等操作

### 2.2 筛选和搜索
- **多条件筛选**: 支持按数据源、状态、参与建模等条件筛选
- **关键词搜索**: 支持按数据点位名称进行模糊搜索
- **筛选重置**: 提供清空筛选条件的功能
- **实时筛选**: 支持筛选条件的实时应用

### 2.3 数据点位详情管理
- **基本信息**: 显示数据点位的基本属性信息
- **数据源配置**: 管理数据点位的来源配置
- **异常规则配置**: 配置数据点位的异常检测规则
- **状态管理**: 管理数据点位的启用/停用状态

### 2.4 异常规则配置
- **规则类型**: 支持多种异常检测规则类型
  - 数据缺失检测
  - 数据重复检测
  - 阈值超限检测
  - 波动/突变检测
  - 趋势检测
  - 噪声检测
  - 时间戳检测
  - 单点异常检测
  - 批量数据检测
- **规则配置**: 每种规则支持配置检测方法、告警级别、处理方式
- **规则启用**: 支持规则的启用/停用控制
- **边缘推送**: 支持将配置的异常规则推送至边缘侧设备，实现本地化异常检测

## 3. 交互说明

### 3.1 页面布局
- **左侧树形结构**: 显示数据点位的层级关系，支持展开/收起
- **右侧列表区域**: 显示当前选中节点的数据点位列表
- **顶部筛选区域**: 提供筛选条件和搜索功能
- **操作按钮区域**: 提供新增、批量操作等功能

### 3.2 数据点位操作
- **查看详情**: 点击查看按钮，弹出详情抽屉，显示完整信息
- **编辑**: 点击编辑按钮，进入编辑模式，可修改数据点位信息
- **配置规则**: 点击配置按钮，打开异常规则配置抽屉
- **状态切换**: 通过开关控制数据点位的启用/停用状态

### 3.3 异常规则配置交互
- **规则抽屉**: 点击配置按钮，从右侧滑出规则配置抽屉
- **规则开关**: 每个规则类型都有独立的启用/停用开关
- **参数配置**: 启用规则后，可配置具体的检测参数
- **保存确认**: 配置完成后，点击确认按钮保存配置
- **边缘推送**: 点击"推送至边缘侧"按钮，将启用的异常规则配置推送至边缘设备

### 3.4 筛选交互
- **条件选择**: 通过下拉框选择筛选条件
- **实时应用**: 选择条件后自动应用筛选
- **清空重置**: 点击清空按钮重置所有筛选条件
- **手动筛选**: 点击筛选按钮手动应用当前筛选条件

## 4. 业务规则

### 4.1 数据点位管理规则
- 数据点位必须属于某个数据源
- 数据点位名称在同一数据源内必须唯一
- 删除数据点位前必须确认无关联的异常规则
- 数据点位的状态变更需要记录操作日志

### 4.2 异常规则配置规则
- 每个数据点位可以配置多种异常检测规则
- 同一种异常规则类型在同一数据点位只能配置一个实例
- 异常规则的告警级别分为：低、中、高、紧急
- 异常规则的处理方式包括：告警、忽略、自动处理
- 推送至边缘侧前必须至少启用一个异常检测规则
- 边缘推送操作需要确认推送状态，推送成功后自动关闭配置抽屉

### 4.3 权限控制规则
- 只有具有管理权限的用户才能进行数据点位的增删改操作
- 普通用户只能查看数据点位信息和状态
- 异常规则配置需要专门的配置权限

### 4.4 数据展示规则
- 数据点位列表按层级顺序显示
- 最新数据实时更新，显示格式为"值 (更新时间)"
- 异常规则数量只统计已启用的规则
- 参与建模状态只对叶子节点有效

## 5. 字段说明

### 5.1 数据点位基本信息字段
- **点位名称** (name): 数据点位的唯一标识名称
- **数据源** (dataSource): 数据点位的来源系统
- **数据类型** (dataType): 数据点位的数值类型
- **单位** (unit): 数据点位的计量单位
- **描述** (description): 数据点位的详细描述信息
- **状态** (status): 数据点位的启用/停用状态
- **参与建模** (modeling): 是否参与数据建模分析

### 5.2 数据点位状态字段
- **最新数据** (lastValue): 数据点位的最新数值
- **最后更新** (lastUpdate): 数据点位最后更新的时间
- **异常规则数量** (ruleCount): 已启用的异常检测规则数量
- **层级** (level): 数据点位在层级结构中的层级数

### 5.3 异常规则配置字段
- **规则类型** (ruleType): 异常检测规则的类型
- **检测方法** (detectionMethod): 具体的检测算法或方法
- **告警级别** (alarmLevel): 异常告警的严重程度级别
- **处理方式** (handlingMethod): 异常发生时的处理策略
- **启用状态** (enabled): 规则是否启用
- **边缘推送状态** (edgePushStatus): 规则是否已推送至边缘侧
- **推送时间** (pushTime): 最后一次推送至边缘侧的时间

### 5.4 筛选条件字段
- **数据源** (dataSource): 按数据源筛选
- **状态** (status): 按启用状态筛选
- **参与建模** (modeling): 按建模参与状态筛选
- **关键词** (keyword): 按名称关键词搜索

### 5.5 操作记录字段
- **操作时间** (operationTime): 操作执行的时间
- **操作类型** (operationType): 操作的类型（新增、编辑、删除等）
- **操作人** (operator): 执行操作的用户
- **操作结果** (result): 操作是否成功
- **备注** (remark): 操作的详细说明 