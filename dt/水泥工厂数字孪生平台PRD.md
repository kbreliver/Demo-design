# 数字孪生平台 - 模型层产品需求文档（PRD）

> 本文档为可交付开发团队的产品需求文档，包含模块结构、页面功能说明、字段定义、交互逻辑及数据说明。

---

## 一、项目概述

- **项目名称**：数字孪生平台 - 模型层模块（资产驱动架构）
- **建设背景**：统一资产模型管理能力，支撑水泥工厂全流程数字孪生。
- **目标用户**：模型管理员、数据管理员、仿真工程师、运维工程师
- **交付目标**：实现结构建模、变量绑定、模型配置、运行监控全流程闭环

---

## 二、页面结构及流转关系

```text
模型管理总览
     ↓
资产结构与变量配置
     ↓
模型资源管理（几何/机理）
     ↓
状态行为与联动配置
     ↓
运行监控与诊断
```

---

## 三、功能需求与字段说明

### 1. 模型管理总览页面

| 功能项  | 描述             |
| ---- | -------------- |
| 模型列表 | 展示所有模型基本信息卡片   |
| 快捷操作 | 新建、复制、编辑、删除、发布 |
| 模型搜索 | 支持按名称、类型、状态筛选  |
| 版本管理 | 查看历史版本、差异对比、回滚 |

#### 字段定义

| 字段名          | 类型       | 示例         | 描述     |
| ------------ | -------- | ---------- | ------ |
| modelName    | string   | 窑系统模型      | 模型名称   |
| modelType    | enum     | 产线/设备      | 模型类别   |
| status       | enum     | 草稿/发布      | 当前状态   |
| lastModified | datetime | 2025-07-21 | 最后修改时间 |

#### 交互说明

- 悬停卡片显示绑定进度、结构数量
- 右键显示操作菜单
- 点击进入“资产结构与变量配置”页

---

### 2. 资产结构与变量配置页面

| 功能项    | 描述                |
| ------ | ----------------- |
| 结构树构建  | 拖拽创建/引用资产类型构建多级结构 |
| 节点属性设置 | 配置节点名称、类型、位置信息等   |
| 变量绑定管理 | 添加/批量导入/模板继承变量    |
| 数据测试   | 实时查看变量数值、采集频率     |

#### 字段定义（变量）

| 字段名      | 类型     | 示例        | 描述      |
| -------- | ------ | --------- | ------- |
| varName  | string | 窑温度       | 变量名称    |
| unit     | string | °C        | 单位      |
| varType  | enum   | float/int | 类型      |
| source   | string | DCS-12345 | 数据来源    |
| interval | int    | 1         | 采集周期（秒） |

#### 交互说明

- 拖拽节点可修改结构层级
- 节点选中右侧显示变量绑定面板
- 悬停变量项查看数据样例

---

### 3. 模型资源管理页面

| 功能项    | 描述                     |
| ------ | ---------------------- |
| 3D模型管理 | 上传/预览/绑定几何模型（IFC、GLTF） |
| 仿真模型配置 | 上传/配置FMU模型，绑定输入输出变量    |
| 模型参数设置 | 配置周期、初值、触发逻辑           |
| 模型绑定   | 拖拽结构节点绑定到模型部件          |

#### 字段定义（仿真模型）

| 字段名        | 类型       | 示例            | 描述        |
| ---------- | -------- | ------------- | --------- |
| simFile    | file     | kiln.fmu      | 模型文件      |
| inputVars  | string[] | [temp, press] | 输入变量集合    |
| outputVars | string[] | [energyLoss]  | 输出变量集合    |
| runCycle   | int      | 5             | 模拟运行周期（秒） |

#### 交互说明

- 拖拽结构树节点 → 绑定几何组件
- 点击“运行模拟” → 实时预览输出结果

---

### 4. 状态行为与联动配置页面

| 功能项    | 描述               |
| ------ | ---------------- |
| 状态定义   | 自定义运行、待机、故障等枚举状态 |
| 转换条件配置 | 表达式定义状态变化条件      |
| 联动行为设置 | 状态触发告警、接口调用、工单生成 |

#### 字段定义（状态）

| 字段名         | 类型     | 示例         | 描述         |
| ----------- | ------ | ---------- | ---------- |
| stateName   | string | 运行         | 状态名称       |
| triggerExpr | string | temp > 900 | 状态触发逻辑表达式  |
| action      | enum[] | [报警, 工单]   | 触发后执行的联动操作 |

#### 交互说明

- 拖拽状态图连接 → 配置条件
- 悬停状态线 → 显示转换逻辑与执行行为

---

### 5. 运行监控与诊断页面

| 功能项     | 描述             |
| ------- | -------------- |
| 实时变量趋势图 | 显示绑定变量的变化曲线    |
| 状态总览    | 实时显示结构节点运行状态   |
| 告警监控    | 实时接收并处理模型运行异常  |
| 3D视图联动  | 高亮模型部件反映运行状态变化 |

#### 字段定义（运行监控）

| 字段名        | 类型       | 示例               | 描述    |
| ---------- | -------- | ---------------- | ----- |
| value      | float    | 875.4            | 当前变量值 |
| timestamp  | datetime | 2025-07-21T10:45 | 时间戳   |
| alarmLevel | enum     | 高                | 告警等级  |

#### 交互说明

- 点击结构节点 → 高亮3D视图部件
- 悬停变量曲线 → 显示数值与时间
- 异常状态变红、闪烁提示

---

## 四、非功能性需求

- 数据刷新延迟 < 3 秒
- 支持万级结构、10w+变量管理能力
- 数据导入导出支持 JSON / XML
- 所有配置具备变更日志、权限控制

---

## 五、开发支持建议

- ✅ 页面原型草图：建议基于上述页面结构开发可交互原型
- ✅ 接口定义文档：字段与交互行为已具备字段说明，可输出 RESTful 接口草稿
- ✅ 测试用例设计：每页功能可进一步拆解为用例并结合 mock 数据测试

如需输出对应原型图、接口定义或开发任务拆解表，我可继续支持。

